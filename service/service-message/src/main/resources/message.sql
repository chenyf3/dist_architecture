CREATE DATABASE /*!32312 IF NOT EXISTS*/`message` /*!40100 DEFAULT CHARACTER SET utf8mb4 */;

USE `message`;

/*Table structure for table `tbl_amq_trace` */
DROP TABLE IF EXISTS `tbl_amq_trace`;
CREATE TABLE `tbl_amq_trace` (
  `ID` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `MSG_TIME` datetime NOT NULL COMMENT '消息生产/消费的时间',
  `CREATE_TIME` datetime NOT NULL COMMENT '创建时间',
  `TRACE_ID` char(32) NOT NULL DEFAULT '' COMMENT '轨迹追踪ID',
  `TRX_NO` varchar(32) NOT NULL DEFAULT '' COMMENT '业务流水号',
  `MCH_NO` char(16) NOT NULL DEFAULT '' COMMENT '商户编号',
  `TOPIC` varchar(64) NOT NULL DEFAULT '' COMMENT '队列名',
  `TOPIC_GROUP` varchar(64) NOT NULL DEFAULT '' COMMENT '队列分组',
  `CONSUME_DEST` varchar(80) NOT NULL DEFAULT '' COMMENT '消费端队列名',
  `TYPE` tinyint(1) NOT NULL COMMENT '消息类型(1=生产 2=消费)',
  `MSG_STATUS` tinyint(1) NOT NULL COMMENT '消息状态(1=生产/消费成功 2=生产/消费失败)',
  `DELIVERY_COUNT` tinyint(2) NOT NULL DEFAULT '1' COMMENT '投递次数(生产者恒为1)',
  `CLIENT_FLAG` varchar(100) NOT NULL DEFAULT '' COMMENT '客户端标识',
  `RESEND` tinyint(1) NOT NULL DEFAULT '2' COMMENT '是否补发的消息(1=是 2=否)',
  `ERR_MSG` varchar(256) NOT NULL DEFAULT '' COMMENT '错误信息',
  `ORI_MSG` json DEFAULT NULL COMMENT '源消息体',
  PRIMARY KEY (`ID`,`MSG_TIME`),
  KEY `IDX_TRX_NO` (`TRX_NO`),
  KEY `IDX_TRACE_ID` (`TRACE_ID`),
  KEY `IDX_MCH_NO` (`MCH_NO`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='mq消息轨迹表'
/*!50100 PARTITION BY RANGE (TO_DAYS(MSG_TIME))
(PARTITION p202003 VALUES LESS THAN (737881) ENGINE = InnoDB,
 PARTITION p202004 VALUES LESS THAN (737911) ENGINE = InnoDB,
 PARTITION p202005 VALUES LESS THAN (737942) ENGINE = InnoDB,
 PARTITION p202006 VALUES LESS THAN (737972) ENGINE = InnoDB,
 PARTITION p202007 VALUES LESS THAN (738003) ENGINE = InnoDB,
 PARTITION p202008 VALUES LESS THAN (738034) ENGINE = InnoDB,
 PARTITION p202009 VALUES LESS THAN (738064) ENGINE = InnoDB,
 PARTITION p202010 VALUES LESS THAN (738095) ENGINE = InnoDB,
 PARTITION p202011 VALUES LESS THAN (738125) ENGINE = InnoDB,
 PARTITION p202012 VALUES LESS THAN (738156) ENGINE = InnoDB,
 PARTITION p202101 VALUES LESS THAN (738187) ENGINE = InnoDB,
 PARTITION p202102 VALUES LESS THAN (738215) ENGINE = InnoDB,
 PARTITION p202103 VALUES LESS THAN (738246) ENGINE = InnoDB,
 PARTITION p202104 VALUES LESS THAN (738276) ENGINE = InnoDB,
 PARTITION p202105 VALUES LESS THAN (738307) ENGINE = InnoDB,
 PARTITION p202106 VALUES LESS THAN (738337) ENGINE = InnoDB,
 PARTITION p202107 VALUES LESS THAN (738368) ENGINE = InnoDB,
 PARTITION p202108 VALUES LESS THAN (738399) ENGINE = InnoDB,
 PARTITION p202109 VALUES LESS THAN (738429) ENGINE = InnoDB,
 PARTITION p202110 VALUES LESS THAN (738460) ENGINE = InnoDB,
 PARTITION p202111 VALUES LESS THAN (738490) ENGINE = InnoDB,
 PARTITION p202112 VALUES LESS THAN (738521) ENGINE = InnoDB,
 PARTITION p202201 VALUES LESS THAN (738552) ENGINE = InnoDB,
 PARTITION p202202 VALUES LESS THAN (738580) ENGINE = InnoDB,
 PARTITION p202203 VALUES LESS THAN (738611) ENGINE = InnoDB,
 PARTITION p202204 VALUES LESS THAN (738641) ENGINE = InnoDB,
 PARTITION p202205 VALUES LESS THAN (738672) ENGINE = InnoDB,
 PARTITION p202206 VALUES LESS THAN (738702) ENGINE = InnoDB,
 PARTITION p202207 VALUES LESS THAN (738733) ENGINE = InnoDB,
 PARTITION p202208 VALUES LESS THAN (738764) ENGINE = InnoDB,
 PARTITION p202209 VALUES LESS THAN (738794) ENGINE = InnoDB,
 PARTITION p202210 VALUES LESS THAN (738825) ENGINE = InnoDB,
 PARTITION p202211 VALUES LESS THAN (738855) ENGINE = InnoDB,
 PARTITION p202212 VALUES LESS THAN (738886) ENGINE = InnoDB,
 PARTITION p202301 VALUES LESS THAN (738917) ENGINE = InnoDB,
 PARTITION p202302 VALUES LESS THAN (738945) ENGINE = InnoDB,
 PARTITION P202303 VALUES LESS THAN (738976) ENGINE = InnoDB,
 PARTITION P202304 VALUES LESS THAN (739006) ENGINE = InnoDB,
 PARTITION P202305 VALUES LESS THAN (739037) ENGINE = InnoDB,
 PARTITION P202306 VALUES LESS THAN (739067) ENGINE = InnoDB,
 PARTITION p202307 VALUES LESS THAN MAXVALUE ENGINE = InnoDB) */;

/*Table structure for table `tbl_mail_receiver` */
DROP TABLE IF EXISTS `tbl_mail_receiver`;
CREATE TABLE `tbl_mail_receiver` (
  `ID` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `CREATE_TIME` datetime NOT NULL COMMENT '创建时间',
  `VERSION` int(11) NOT NULL DEFAULT '0' COMMENT '版本号',
  `GROUP_KEY` varchar(64) NOT NULL COMMENT '分组名',
  `REMARK` varchar(100) NOT NULL COMMENT '描述/备注',
  `SENDER` varchar(80) NOT NULL COMMENT '发件人',
  `RECEIVERS` json DEFAULT NULL COMMENT '收件人',
  PRIMARY KEY (`ID`),
  UNIQUE KEY `unq_key` (`GROUP_KEY`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='邮件接收人';
